import{i as S,j as f,G as T,k as v,l as c,o as l,c as _,w as n,a as s,e as a,h as p,b as d,t as g,g as V,F,f as m}from"./app-c5eb5df1.js";import{C as U}from"./Ckeditor-04e30514.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";const D={components:{Link:S,CkeditorPost:U},data(){return{dialogVisible:!1,imageSelected:"",dataForm:{title:"",description:"",image:"",content:"",hagtags:[],is_notice:"1"},listHagTag:[],listCategory:"",categorySelect:"",errors:[]}},watch:{dialogVisible(i){i==!1&&this.clearResult()}},methods:{async clearResult(){this.imageSelected="",this.dataForm.title="",this.dataForm.description="",this.dataForm.image="",this.$refs.content&&(this.$refs.content.editorData=""),this.dataForm.is_notice="1",this.categorySelect="",this.listCategory="",this.listHagTag=[],this.errors=[]},async fetchData(){const i=await f.get(route("list-hagtag"));this.listHagTag=i.data},open(){this.dialogVisible=!0,this.clearResult(),this.fetchData()},cancel(){this.dialogVisible=!1},async changeImage(i){try{const e=i.target.files||i.dataTransfer.files;if(!e.length)return;if(e[0].size>5*1024*1024)return this.$message.warning(this.$i18n.t("File quá lớn, dung lượng tối đa cho phép 5MB")),!1;const x=e[0].name.substring(e[0].name.lastIndexOf(".")),h=[".png",".bmp",".jpeg",".tif",".gif",".jpg"];if(!h.find(t=>t===x))return this.$message.warning(this.$i18n.t("File sai định dạng. Cần thuộc các định dạng sau: ")+h.join(", ")),!1;this.dataForm.image=e[0],this.imageSelected=URL.createObjectURL(e[0])}catch(e){console.log("handleUploadContent",e)}},findCategory(){const i=T.service({lock:!0,text:"Đang tiến hành phân loại",background:"rgba(0, 0, 0, 0.7)"}),e=new FormData,x=this.$refs.content.editorData.replace(/(<([^>]+)>)/gi,"").replace(/&nbsp;/gi,"");e.append("content",x),f.post("http://127.0.0.1:5000/classify",e).then(h=>{this.listCategory=h.data,i.close()})},addPost(){this.errors=[];const i=new FormData;i.append("title",this.dataForm.title??""),i.append("description",this.dataForm.description??""),i.append("image",this.dataForm.image??""),i.append("content",this.$refs.content.editorData??""),i.append("hagtags",this.dataForm.hagtags??""),i.append("category",this.categorySelect),i.append("is_notice",this.dataForm.is_notice),f.post(route("creator.posts.store",this.id),i).then(()=>{v({showClose:!0,message:"Thêm bài viết thành công",type:"success"}),this.dialogVisible=!1,this.$emit("change-post")}).catch(e=>{v({showClose:!0,message:"Vui lòng kiểm tra lại dữ liệu nhập",type:"error"}),this.errors=e.response.data.errors})}}},H=s("div",{class:"text-center font-bold text-[18px]"}," Thêm bài viết mới ",-1),N={class:"mx-[4px] mt-[42px]"},z={class:"mt-[18px]"},B=s("div",{class:"text-[16px] font-bold text-[#000]"},[m("Tiêu đề "),s("span",{class:"text-[red]"},"*")],-1),L={key:0,class:"mt-[5px] text-[#ff0000]"},R={class:"mt-[18px]"},I=s("div",{class:"text-[16px] font-bold text-[#000]"},"Mô tả ",-1),E={key:0,class:"mt-[5px] text-[#ff0000]"},M={class:"mt-[18px]"},q=s("div",{class:"text-[16px] font-bold text-[#000]"},"Hagtag",-1),A={class:"mt-[18px]"},G=s("div",{class:"text-[16px] font-bold text-[#000] mb-[8px]"},"Thông báo",-1),K={class:"mt-[18px]"},O=s("div",{class:"text-[16px] font-bold text-[#000]"},[m("Hình ảnh "),s("span",{class:"text-[red]"},"*")],-1),X={key:0,class:"w-[280px] mt-[8px]"},J=["src"],Q=s("i",{class:"bi bi-upload text-lg mr-[8px] text-white"},null,-1),W={key:1,class:"mt-[5px] text-[#ff0000]"},Y={class:"mt-[18px]"},Z=s("div",{class:"text-[16px] font-bold text-[#000]"},[m("Nội dung "),s("span",{class:"text-[red]"},"*")],-1),$={key:0,class:"mt-[5px] text-[#ff0000]"},ee={key:0,class:"list-find-category mt-[18px]"},te=s("div",{class:"text-[16px] font-bold text-[#000]"},"Kết quả phân loại",-1),se={class:"mt-[6px] mx-[12px]"},oe={class:"font-bold"},ie={class:"font-bold"},le={class:"pb-[12px] pt-[8px]"},ne={class:"flex justify-end text-[14px] mr-[24px]"};function ae(i,e,x,h,t,r){const b=c("el-input"),k=c("el-option"),C=c("el-select"),u=c("el-radio"),y=c("el-radio-group"),w=c("ckeditor-post"),j=c("el-dialog");return l(),_(j,{modelValue:t.dialogVisible,"onUpdate:modelValue":e[10]||(e[10]=o=>t.dialogVisible=o),id:"add-post",class:"bg-[#f4f1f8] max-h-[90%] overflow-scroll",width:"900px",style:{"margin-top":"18px !important"},"show-close":!0},{header:n(()=>[H]),footer:n(()=>[s("div",le,[s("div",ne,[s("div",{onClick:e[7]||(e[7]=(...o)=>r.cancel&&r.cancel(...o)),class:"cursor-pointer flex justify-center items-center w-[110px] rounded-[4px] bg-[#ffffff] py-[4px] h-[32px] text-[15px] text-black border border-[#7d7f92]"}," Hủy bỏ "),s("div",{class:"cursor-pointer flex justify-center items-center w-[110px] ml-[18px] rounded-[4px] bg-[#007bff] py-[4px] h-[32px] text-[15px] text-white",onClick:e[8]||(e[8]=(...o)=>r.findCategory&&r.findCategory(...o))}," Phân loại "),t.categorySelect?(l(),a("div",{key:0,class:"cursor-pointer flex justify-center items-center w-[110px] ml-[18px] rounded-[4px] bg-[#007bff] py-[4px] h-[32px] text-[15px] text-white",onClick:e[9]||(e[9]=(...o)=>r.addPost&&r.addPost(...o))}," Xác nhận ")):p("",!0)])])]),default:n(()=>[s("div",N,[s("div",z,[B,d(b,{class:"mt-[2px]",modelValue:t.dataForm.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.dataForm.title=o),placeholder:"Nhập tiêu đề",clearable:""},null,8,["modelValue"]),t.errors.title?(l(),a("div",L,g(t.errors.title[0]),1)):p("",!0)]),s("div",R,[I,d(b,{class:"mt-[2px]",modelValue:t.dataForm.description,"onUpdate:modelValue":e[1]||(e[1]=o=>t.dataForm.description=o),placeholder:"Nhập mô tả",clearable:""},null,8,["modelValue"]),t.errors.description?(l(),a("div",E,g(t.errors.description[0]),1)):p("",!0)]),s("div",M,[q,d(C,{modelValue:t.dataForm.hagtags,"onUpdate:modelValue":e[2]||(e[2]=o=>t.dataForm.hagtags=o),class:"mt-[2px] max-w-[250px]",placeholder:"Chọn hagtag",multiple:""},{default:n(()=>[(l(!0),a(F,null,V(t.listHagTag,o=>(l(),_(k,{key:o.name,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",A,[G,d(y,{modelValue:t.dataForm.is_notice,"onUpdate:modelValue":e[3]||(e[3]=o=>t.dataForm.is_notice=o),size:"large"},{default:n(()=>[d(u,{label:"1",size:"large",border:""},{default:n(()=>[m("Gửi thông báo")]),_:1}),d(u,{label:"0",size:"large",border:""},{default:n(()=>[m("Không gửi thông báo")]),_:1})]),_:1},8,["modelValue"])]),s("div",K,[O,t.imageSelected!=""?(l(),a("div",X,[s("img",{src:t.imageSelected,alt:"",class:"rounded-[4px]"},null,8,J)])):p("",!0),s("div",{class:"cursor-pointer flex justify-center items-center w-[180px] rounded-[20px] bg-[#007bff] px-[10px] py-[4px] h-[32px] text-[14px] text-white mt-[8px]",onClick:e[5]||(e[5]=o=>this.$refs.file.click())},[s("input",{type:"file",ref:"file",accept:".jpg,.png,.bmp,.jpeg,.tif,.gif",onChange:e[4]||(e[4]=(...o)=>r.changeImage&&r.changeImage(...o)),hidden:""},null,544),Q,m(" Upload hình ảnh ")]),t.errors.image?(l(),a("div",W,g(t.errors.image[0]),1)):p("",!0)]),s("div",Y,[Z,d(w,{class:"mt-[8px]",ref:"content",contentProp:t.dataForm.content},null,8,["contentProp"]),t.errors.content?(l(),a("div",$,g(t.errors.content[0]),1)):p("",!0)]),t.listCategory.length!=0?(l(),a("div",ee,[te,s("div",se,[d(y,{modelValue:t.categorySelect,"onUpdate:modelValue":e[6]||(e[6]=o=>t.categorySelect=o),size:"large"},{default:n(()=>[(l(!0),a(F,null,V(t.listCategory,o=>(l(),_(u,{label:o.slug,size:"large",border:""},{default:n(()=>[s("span",oe,g(o.name),1),m(" : "),s("span",ie,g(o.value)+" %",1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])])])):p("",!0)])]),_:1},8,["modelValue"])}const pe=P(D,[["render",ae]]);export{pe as default};
