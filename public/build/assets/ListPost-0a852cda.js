import{A}from"./AppLayoutAdmin-d2e3b506.js";import{i as L,j as u,k as _,E as N,l as i,o as c,c as d,w as o,a as s,n as v,b as r,e as m,g as y,F as k,t as h,f as g,h as P}from"./app-2a871929.js";import{D as B}from"./DataTable-8bf8d838.js";import{P as E}from"./Paginate-55ef9a15.js";import j from"./ShowPost-57d16695.js";import U from"./EditPost-a0c66022.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./Dropdown-4ecace4f.js";import"./moment-fbc5633a.js";import"./Ckeditor-fd58bb26.js";const M={components:{AppLayoutAdmin:A,Link:L,Paginate:E,DataTable:B,ShowPostForm:j,EditPostForm:U},data(){return{tab:"tab-0",fields:[{key:"title",label:"Tiêu đề",align:"center",width:200},{key:"categoryName",label:"Chủ đề",align:"center",width:130},{key:"content",label:"Nội dung",align:"center"},{key:"image",label:"Hình ảnh",align:"center",width:160},{key:"status",label:"Trạng thái",align:"center",width:100},{key:"created_at",label:"Ngày tạo",align:"center",width:140},{key:"updated_at",label:"Ngày cập nhật",align:"center",width:140},{key:"options",label:"Options",align:"center",width:90}],options:[6,12,24,32],filterSearch:{limit:6,categorySelect:[],search:"",page:1},paginate:[],tableData:[],selectedValue:[]}},created(){this.fetchData(),document.title="Quản lý bài viết - Admin hệ thống"},methods:{clearFilter(){this.filterSearch.page=1,this.filterSearch.isApproved="2",this.filterSearch.search="",this.filterSearch.limit=10,this.paginate=[],this.tableData=[]},async fetchData(){const a={...this.filterSearch},t=await u.get(route("admin.posts.index",a));this.tableData=t.data.data,this.paginate=t.data.meta},changeTab(a){this.tab=a,this.clearFilter(),this.tab=="tab-0"?this.filterSearch.isApproved=!0:this.filterSearch.isApproved=!1,this.fetchData()},handleCurrentPage(a){this.filterSearch.page=a,this.fetchData()},handleSelectionChange(a){this.selectedValue=a},editPost(a){this.$refs.editPostForm.open(a)},showPost(a){this.$refs.showPostForm.open(a)},changeStatus(a){u.get(route("admin.posts.change-status",a.id)).then(t=>{this.fetchData()})},deletePosts(){this.selectedValue.length==0?_({type:"warning",message:"Vui lòng chọn bài viết muốn xóa"}):N.confirm("Bạn có muốn xóa các bài viết vừa chọn không?","Warning",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy bỏ",type:"warning",draggable:!0}).then(()=>{const a={posts:this.selectedValue};u.post(route("admin.posts.delete-posts"),a).then(t=>{this.fetchData(),_({type:"success",message:"Xóa bài viết thành công"})})}).catch(()=>{})}}},X=s("div",{class:"mt-[12px] flex text-[18px] font-bold uppercase"}," Danh sách bài viết ",-1),z={class:"mt-[12px] flex items-center text-[15px] border-b-[3px] border-b-[#adb5bd]"},R={class:"my-[24px]"},q={class:"mb-[18px] flex items-center"},K=["onClick"],O={class:"text-left hover:text-[blue]"},Q=["innerHTML"],W=["src"],G={class:"h-[36px] flex justify-center items-center"},I={class:"mx-[6px]"},J={class:"mx-[6px]"},Y={class:"flex justify-center"},Z=s("i",{class:"bi bi-arrow-right-square"},null,-1),$=["onClick"],ee=s("i",{class:"bi bi-gear-fill"},null,-1),te=[ee],ae={key:0,class:"flex justify-end mt-[32px] mr-[16px]"};function se(a,t,le,ne,l,n){const f=i("el-option"),x=i("el-select"),C=i("el-input"),b=i("Link"),S=i("el-switch"),w=i("DataTable"),D=i("Paginate"),V=i("EditPostForm"),F=i("ShowPostForm"),T=i("AppLayoutAdmin");return c(),d(T,{currentTab:"tab-4"},{"main-full":o(()=>[X,s("div",z,[s("div",{class:v(["w-[120px] text-center py-[6px] cursor-pointer",{"bg-[#495057] text-white":l.tab=="tab-0"}]),onClick:t[0]||(t[0]=e=>n.changeTab("tab-0"))}," Đã duyệt ",2),s("div",{class:v(["w-[120px] text-center py-[6px] cursor-pointer",{"bg-[#495057] text-white":l.tab=="tab-1"}]),onClick:t[1]||(t[1]=e=>n.changeTab("tab-1"))}," Chưa duyệt ",2)]),s("div",R,[s("div",q,[r(x,{modelValue:l.filterSearch.limit,"onUpdate:modelValue":t[2]||(t[2]=e=>l.filterSearch.limit=e),class:"max-w-[60px] ml-[8px]",onChange:t[3]||(t[3]=e=>n.fetchData())},{default:o(()=>[(c(!0),m(k,null,y(l.options,e=>(c(),d(f,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),r(x,{class:"ml-[18px] max-w-[300px]",modelValue:l.filterSearch.categorySelect,"onUpdate:modelValue":t[4]||(t[4]=e=>l.filterSearch.categorySelect=e),placeholder:"Chọn danh mục",multiple:"","multiple-limit":"2",clearable:"",onChange:n.fetchData},{default:o(()=>[(c(!0),m(k,null,y(this.$page.props.categories,e=>(c(),d(f,{key:e.slug,label:e.name,value:e.slug},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),r(C,{class:"mx-[20px] max-w-[300px]",modelValue:l.filterSearch.search,"onUpdate:modelValue":t[5]||(t[5]=e=>l.filterSearch.search=e),placeholder:"Nhập từ khóa",clearable:"",onKeyup:t[6]||(t[6]=e=>n.fetchData())},null,8,["modelValue"]),s("div",{class:"text-[14px] px-[24px] py-[4px] rounded-[4px] bg-[red] text-white cursor-pointer",onClick:t[7]||(t[7]=(...e)=>n.deletePosts&&n.deletePosts(...e))}," Xóa bài ")]),r(w,{fields:l.fields,items:l.tableData,"enable-select-box":"",onRowSelected:n.handleSelectionChange},{title:o(({row:e})=>[s("div",{class:"text-left cursor-pointer hover:text-[blue]",onClick:p=>n.editPost(e)},h(e.title),9,K)]),slug:o(({row:e})=>[s("div",O,[r(b,{href:a.route("post",e.slug)},{default:o(()=>[g(h(e.slug),1)]),_:2},1032,["href"])])]),content:o(({row:e})=>[s("div",{class:"text-left post-content",innerHTML:e.content},null,8,Q)]),image:o(({row:e})=>[s("img",{src:e.image,alt:"",class:"object-cover h-[120px] w-[100%]"},null,8,W)]),status:o(({row:e})=>[s("div",G,[r(S,{modelValue:e.status,"onUpdate:modelValue":p=>e.status=p,style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"inline-prompt":"","active-text":"Activated","inactive-text":"Deactivated",size:"default",onClick:p=>n.changeStatus(e)},null,8,["modelValue","onUpdate:modelValue","onClick"])])]),created_at:o(({row:e})=>[g(h(e.created_at)+" ",1),s("div",I,"("+h(e.creator)+")",1)]),updated_at:o(({row:e})=>[g(h(e.updated_at)+" ",1),s("div",J,"("+h(e.updater)+")",1)]),options:o(({row:e})=>[s("div",Y,[l.tab=="tab-0"?(c(),d(b,{key:0,href:a.route("post",e.slug),class:"text-[20px] cursor-pointer mr-[8px]"},{default:o(()=>[Z]),_:2},1032,["href"])):P("",!0),s("div",{class:"text-[20px] cursor-pointer",onClick:p=>n.showPost(e)},te,8,$)])]),_:1},8,["fields","items","onRowSelected"]),l.tableData.length!=0?(c(),m("div",ae,[r(D,{onPageChange:n.handleCurrentPage,paginate:l.paginate,"current-page":l.filterSearch.page||1,"paginate-background":""},null,8,["onPageChange","paginate","current-page"])])):P("",!0)]),r(V,{ref:"editPostForm",onChangePost:n.fetchData},null,8,["onChangePost"]),r(F,{ref:"showPostForm",onChangePost:n.fetchData},null,8,["onChangePost"])]),_:1})}const fe=H(M,[["render",se]]);export{fe as default};
