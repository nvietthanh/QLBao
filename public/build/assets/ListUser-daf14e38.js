import{A as w}from"./AppLayoutAdmin-d2e3b506.js";import{i as T,j as h,E as u,k as p,l as o,o as c,c as f,w as d,a as l,n as b,b as i,e as m,g as D,F as V,m as B,h as A}from"./app-2a871929.js";import{D as F}from"./DataTable-8bf8d838.js";import{P}from"./Paginate-55ef9a15.js";import L from"./ChangeStatusForm-bd7b312a.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";import"./Dropdown-4ecace4f.js";import"./moment-fbc5633a.js";const X={components:{AppLayoutAdmin:w,Link:T,Paginate:P,DataTable:F,ShowChangeStatustForm:L},data(){return{tab:"tab-0",fields:[{key:"code",label:"Code",align:"center",width:120},{key:"name",label:"Họ tên",align:"center"},{key:"email",label:"Email",align:"center"},{key:"created_at",label:"Ngày tạo",align:"center",width:180},{key:"status",label:"Trạng thái",align:"center",width:150},{key:"status_expires_at",label:"Thời gian mở khóa",align:"center",width:160},{key:"options",label:"Tùy chỉnh",align:"center",width:130}],options:[10,20,30],filterSearch:{limit:10,type:"Reader",isApproved:"2",search:"",page:1},paginate:[],tableData:[],selectedValue:[]}},created(){this.fetchData(),document.title="Quản lý người dùng - Admin hệ thống"},methods:{clearFilter(){this.filterSearch.page=1,this.filterSearch.isApproved="2",this.filterSearch.search="",this.filterSearch.limit=10,this.paginate=[],this.tableData=[]},async fetchData(){const n={...this.filterSearch},e=await h.get(route("admin.accounts.index",n));this.tableData=e.data.data,this.paginate=e.data.meta},changeTab(n){this.tab=n,this.clearFilter(),this.tab=="tab-0"?this.filterSearch.type="Reader":this.filterSearch.type="Creator",this.fetchData()},handleCurrentPage(n){this.filterSearch.page=n,this.fetchData()},handleSelectionChange(n){this.selectedValue=n},changeStatus(n){this.$refs.showChangeStatusForm.open(n)},changeToCreator(n){u.confirm(`Bạn có muốn chuyển người dùng ${n.email} thành tác giả không?`,"Warning",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy bỏ",type:"warning",draggable:!0}).then(()=>{h.get(route("admin.accounts.change-to-creator",n.id)).then(e=>{this.fetchData(),p({type:"success",message:"Chuyển người dùng thành tác giả thành công"})})}).catch(()=>{})},changeToReader(n){u.confirm(`Bạn có muốn chuyển tác giả ${n.email} thành độc giả không?`,"Warning",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy bỏ",type:"warning",draggable:!0}).then(()=>{h.get(route("admin.accounts.change-to-reader",n.id)).then(e=>{this.fetchData(),p({type:"success",message:"Chuyển người dùng thành độc giả thành công"})})}).catch(()=>{})},deleteSelection(n){u.confirm(`Bạn có muốn xóa tài khoản ${n.email} không?`,"Warning",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy bỏ",type:"warning",draggable:!0}).then(()=>{h.delete(route("admin.accounts.destroy",n.id)).then(e=>{this.fetchData(),p({type:"success",message:"Xoá tài khoản người dùng thành công"})})}).catch(()=>{})},deleteSelections(){this.selectedValue.length==0?p({type:"warning",message:"Chọn tài khoản người dùng muốn xóa"}):u.confirm("Bạn có muốn xóa các tài khoản đã chọn không?","Warning",{confirmButtonText:"Xác nhận",cancelButtonText:"Hủy bỏ",type:"warning",draggable:!0}).then(()=>{const n={accounts:this.selectedValue};h.post(route("admin.accounts.delete-accounts"),n).then(e=>{this.fetchData(),p({type:"success",message:"Xoá tài khoản người dùng thành công"})})}).catch(()=>{})}}},N=l("div",{class:"mt-[12px] flex text-[18px] font-bold uppercase"}," Danh sách người dùng ",-1),R={class:"mt-[12px] flex items-center text-[15px] border-b-[3px] border-b-[#adb5bd]"},E={class:"my-[28px]"},H={class:"mb-[18px] flex items-center"},W={class:"h-[36px] flex justify-center items-center"},j=["onClick"],K=l("i",{class:"bi bi-person-fill-check"},null,-1),M=[K],z=["onClick"],Q=l("i",{class:"bi bi-person-fill-x"},null,-1),q=[Q],G=["onClick"],I=l("i",{class:"bi bi-person-fill-gear"},null,-1),J=[I],O=["onClick"],Y=l("i",{class:"bi bi-trash3-fill"},null,-1),Z=[Y],$={key:0,class:"flex justify-end mt-[32px] mr-[16px]"};function ee(n,e,te,ne,a,s){const g=o("el-option"),x=o("el-select"),_=o("el-input"),y=o("el-switch"),k=o("DataTable"),C=o("Paginate"),v=o("ShowChangeStatustForm"),S=o("AppLayoutAdmin");return c(),f(S,{currentTab:"tab-1"},{"main-full":d(()=>[N,l("div",R,[l("div",{class:b(["w-[120px] text-center py-[6px] cursor-pointer",{"bg-[#495057] text-white":a.tab=="tab-0"}]),onClick:e[0]||(e[0]=t=>s.changeTab("tab-0"))}," Người đọc ",2),l("div",{class:b(["w-[120px] text-center py-[6px] cursor-pointer",{"bg-[#495057] text-white":a.tab=="tab-1"}]),onClick:e[1]||(e[1]=t=>s.changeTab("tab-1"))}," Tác giả ",2)]),l("div",E,[l("div",H,[i(x,{modelValue:a.filterSearch.limit,"onUpdate:modelValue":e[2]||(e[2]=t=>a.filterSearch.limit=t),class:"max-w-[60px] ml-[8px]",onChange:e[3]||(e[3]=t=>s.fetchData())},{default:d(()=>[(c(!0),m(V,null,D(a.options,t=>(c(),f(g,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),i(x,{modelValue:a.filterSearch.isApproved,"onUpdate:modelValue":e[4]||(e[4]=t=>a.filterSearch.isApproved=t),class:"max-w-[140px] ml-[20px]",onChange:e[5]||(e[5]=t=>s.fetchData())},{default:d(()=>[i(g,{label:"Tất cả",value:"2"}),i(g,{label:"Đã kích hoạt",value:"1"}),i(g,{label:"Chưa kích hoạt",value:"0"})]),_:1},8,["modelValue"]),i(_,{class:"mx-[20px] max-w-[300px]",modelValue:a.filterSearch.search,"onUpdate:modelValue":e[6]||(e[6]=t=>a.filterSearch.search=t),placeholder:"Nhập từ khóa",clearable:"",onKeyup:e[7]||(e[7]=B(t=>s.fetchData(),["enter"]))},null,8,["modelValue"]),l("div",{class:"text-[14px] bg-[red] w-[130px] h-[32px] leading-[32px] text-white text-center rounded-[4px] cursor-pointer",onClick:e[8]||(e[8]=(...t)=>s.deleteSelections&&s.deleteSelections(...t))}," Xóa người dùng ")]),i(k,{fields:a.fields,items:a.tableData,"enable-select-box":"",onRowSelected:s.handleSelectionChange},{status:d(({row:t})=>[l("div",W,[i(y,{modelValue:t.status,"onUpdate:modelValue":r=>t.status=r,style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"inline-prompt":"","active-text":"Activated","inactive-text":"Deactivated",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])]),options:d(({row:t})=>[a.tab=="tab-0"?(c(),m("span",{key:0,class:"px-[6px] py-[8px] text-[22px] cursor-pointer",onClick:r=>s.changeToCreator(t)},M,8,j)):(c(),m("span",{key:1,class:"px-[6px] py-[8px] text-[22px] cursor-pointer",onClick:r=>s.changeToReader(t)},q,8,z)),l("span",{class:"px-[6px] py-[8px] text-[24px] cursor-pointer",onClick:r=>s.changeStatus(t)},J,8,G),l("span",{class:"px-[6px] py-[8px] text-[20px] cursor-pointer",onClick:r=>s.deleteSelection(t)},Z,8,O)]),_:1},8,["fields","items","onRowSelected"]),a.tableData.length!=0?(c(),m("div",$,[i(C,{onPageChange:s.handleCurrentPage,paginate:a.paginate,"current-page":a.filterSearch.page||1,"paginate-background":""},null,8,["onPageChange","paginate","current-page"])])):A("",!0)]),i(v,{ref:"showChangeStatusForm",onChangeAccount:e[9]||(e[9]=t=>s.fetchData())},null,512)]),_:1})}const pe=U(X,[["render",ee]]);export{pe as default};
